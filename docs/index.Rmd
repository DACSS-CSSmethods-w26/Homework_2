<center><img src="https://github.com/DACSS-CSSmeths/guidelines/blob/main/pics/small_logo_ccs_meths.jpg?raw=true" width="700"/></center>

# Homework 2: Social Networks in R

## Kayla Freeman

------------------------------------------------------------------------

## I. Getting Ready:

* Set seed

```{r}
set.seed(1111)
```



### II. Network Creation from dataframes


```{r}
## link to file on GitHub
fileLink='https://raw.githubusercontent.com/DACSS-CSSmethods-w26/Homework_2/refs/heads/main/docs/hollywood.graphml'

library(igraph) # package needed

#read in the graph file
actors=read_graph(fileLink,format='graphml')

```


## III. Exploration of Network nodes

Let's compute measures for each node, and save them into a data frame:


```{r}

#compute eigenvector
eigen=eigen_centrality(actors)$vector

#compute closeness
close=closeness(actors,normalized=T)

#compute betweeness
betw=betweenness(actors,normalized=T)

#create a centrality dataset
DFCentrality=as.data.frame(cbind(eigen,close,betw),stringsAsFactors = F)
names(DFCentrality)=c('Eigenvector','Closeness','Betweenness')

DFCentrality$person=row.names(DFCentrality)
row.names(DFCentrality)=NULL
DFCentrality
```

```{r}
library(ggplot2) #needed library

#create the correlation plot
ggplot(DFCentrality, aes(x=Betweenness, y=Closeness)) + 
    theme_classic() +
    geom_text(aes(label=person,size=Eigenvector),show.legend = T,alpha=0.5) 
```

- Al Pacino and Robert De Niro have the highest eigenvectors, so they are they most influential (they are connected to vertices that are also well connected).

- Tom Hanks has the highest closeness, so he can share information faster than the rest.

- Tom Hanks and Matt Damon have the highest betweenness, indicating that they are important to connect vertices that are not connected directly.


## IV. Communities

### IV.1 **Potential Communities?**

a. Computing a random network:

```{r}
#create a random network
RandomNet <- sample_gnp(length(V(actors)),p=edge_density(actors))
```

b. Get Transitivity rate

```{r}

#get the transitivity rate
transitivity(actors)/transitivity(RandomNet)
```
The above code shows that the transitivity of the actors network divided by the transitivity of a random network is less than 1.  Therefore, there is not evidence that there are potential communities.  


### 5.2 **Two approaches**

a. Girvan-Newman:


The **girvan_newman** algorithm is based on creating partitions using the centrality of nodes to create partition too. We can create something similar to the last result like this:


```{r}
# Membership vector will be selected based 
# on the highest modularity score
partition_girvanNewman_best <- cluster_edge_betweenness(actors)
```


The modularity:
```{r}
#calculate the max modularity
max(partition_girvanNewman_best$modularity)
```

b. Louvain:


```{r}
#calculate communities based on the louvain algorithm (bottom-up method)
partition_louvain_optimal <- cluster_louvain(actors)
```

The modularity:
```{r}
#calculate the max modularity
max(partition_louvain_optimal$modularity)
```

### 5.3 **Plotting communities**

First, creating new columns:

```{r}
#since Girvan-Newman has a higher modularity, add it to the dataset for plotting
V(actors)$girvanNewman=as.factor(membership(partition_girvanNewman_best))
```

Now plot the one with the best modularity (Girvan-Newman):

```{r}
library(ggraph)

#graph the Girvan-Newman communities
base=ggraph(graph =actors,layout = 'fr') + geom_edge_link(alpha=0.2)
base + geom_node_point(aes(color=girvanNewman), show.legend = T, size=4)
```

